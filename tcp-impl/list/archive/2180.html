<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>TCP-IMPL Mailing List Archive: Re: ISA used in TCP/IP/UDP</TITLE>
<META NAME="Author" CONTENT="Patrick Klos (patrick@klos.com)">
<META NAME="Subject" CONTENT="Re: ISA used in TCP/IP/UDP">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>Re: ISA used in TCP/IP/UDP</H1>
<!-- received="Tue Jun 20 13:43:47 2000" -->
<!-- isoreceived="20000620174347" -->
<!-- sent="Tue, 20 Jun 2000 13:36:21 -0400" -->
<!-- isosent="20000620173621" -->
<!-- name="Patrick Klos" -->
<!-- email="patrick@klos.com" -->
<!-- subject="Re: ISA used in TCP/IP/UDP" -->
<!-- id="200006201736.NAA08686@klos.com" -->
<!-- inreplyto="ISA used in TCP/IP/UDP" -->
<STRONG>From:</STRONG> Patrick Klos (<A HREF="mailto:patrick@klos.com?Subject=Re:%20ISA%20used%20in%20TCP/IP/UDP&In-Reply-To=&lt;200006201736.NAA08686@klos.com&gt;"><EM>patrick@klos.com</EM></A>)<BR>
<STRONG>Date:</STRONG> Tue Jun 20 2000 - 13:36:21 EDT
<P>
<!-- next="start" -->
<UL>
<LI><STRONG>Next message:</STRONG> <A HREF="2181.html">Vernon Schryver: "Re: ISA used in TCP/IP/UDP"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="2179.html">Joe Touch: "Re: ISA used in TCP/IP/UDP"</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="2166.html">Wilson C. Chung: "ISA used in TCP/IP/UDP"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="2182.html">Joe Touch: "Re: ISA used in TCP/IP/UDP"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="2182.html">Joe Touch: "Re: ISA used in TCP/IP/UDP"</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#2180">[ date ]</A>
<A HREF="index.html#2180">[ thread ]</A>
<A HREF="subject.html#2180">[ subject ]</A>
<A HREF="author.html#2180">[ author ]</A>
</UL>
<HR NOSHADE><P>
<!-- body="start" -->
<P>
<EM>&gt;&gt; Sure, if you have DMA.  A DMA controller that could compute a running
</EM><BR>
<EM>&gt;&gt; checksum would be cool.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;We implemented one here at ISI in 1996, and it was based on emulating in
</EM><BR>
<EM>&gt;multiple chips what other DMA designers had already done. Not so much
</EM><BR>
<EM>&gt;cool, as cold.
</EM><BR>
<P>Well, I expect (most of) the rest of the world hasn't seen this 
<BR>
implementation.  Nor am I aware of any processor (i.e. single CPU) that 
<BR>
has integrated such a feature into it's core.
<BR>
<P><EM>&gt;&gt; Ones complement add is already very easy to do with existing processors.
</EM><BR>
<EM>&gt;&gt; I'm talking about instructions that automatically add to a checksum as
</EM><BR>
<EM>&gt;&gt; a packet's contents are being copied (since they very often are unless
</EM><BR>
<EM>&gt;&gt; you have scatter-gather hardware to collect up the pieces of a packet,
</EM><BR>
<EM>&gt;&gt; in which case your other suggestion would work out).
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Given typical processor pipelines, the arithmetic 'carry-add' is masked
</EM><BR>
<EM>&gt;by the bubble generated by the data move anyway.
</EM><BR>
<P>You appear to be missing the point - the original question asked was &quot;what
<BR>
instructions could be added to a processor to make coding TCP/IP stacks
<BR>
more efficient&quot; (if I paraphrased it correctly?).  Maybe this person 
<BR>
wants to build a new lightweight processor with similar efficiency to
<BR>
today's complex processors, and target network devices specifically?
<BR>
<P><EM>&gt;&gt; &gt;&gt; 5)  Built-in &quot;mbuf&quot;s?  I.e. the processor understands a specific scheme
</EM><BR>
<EM>&gt;&gt; &gt;&gt;     of chaining buffers to create packets, thus can more efficiently
</EM><BR>
<EM>&gt;&gt; &gt;&gt;     poke around in a packet for you, rather then your code having to
</EM><BR>
<EM>&gt;&gt; &gt;&gt;     always do it by hand.
</EM><BR>
<EM>&gt;&gt; &gt;
</EM><BR>
<EM>&gt;&gt; &gt;Assumes mbufs. There are versions of TCP that don't rely on that
</EM><BR>
<EM>&gt;&gt; &gt;structure, and the structure and especially the order of its components
</EM><BR>
<EM>&gt;&gt; &gt;can be OS and even compiler-specific.
</EM><BR>
<EM>&gt;&gt; 
</EM><BR>
<EM>&gt;&gt; Yes, it assumes mbufs.  It also assumes that a TCP stack for this special
</EM><BR>
<EM>&gt;&gt; processor would be optimized for this processor.  Most TCP stacks have
</EM><BR>
<EM>&gt;&gt; some notion similar to mbufs to help minimize copying packet contents
</EM><BR>
<EM>&gt;&gt; all over the place.  My suggestion is just to capitalize on a version of
</EM><BR>
<EM>&gt;&gt; that notion to speed up access to packet contents when necessary.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Lisp processors tried this before, and it works. You can build deep data
</EM><BR>
<EM>&gt;structure knowledge into the processor if you want. While this is useful
</EM><BR>
<EM>&gt;for the scatter-gather DMA, why is it useful for a processor to be able
</EM><BR>
<EM>&gt;to do?
</EM><BR>
<P>It could make it easier to have code that says &quot;give me bytes 20 and 21
<BR>
of this packet&quot; without the code having to walk the mbufs itself.  It
<BR>
would make it easier to extract data from the packet arbitrarily.
<BR>
<P>You make it sound as if you don't think there are any possible enhancements
<BR>
that could be made to a processor to optimize TCP/IP stack implementation?
<BR>
Maybe the processors you use are not practical for the person who started
<BR>
this thread??
<BR>
============================================================================
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;Patrick Klos                           Email: <A HREF="mailto:patrick@klos.com?Subject=Re:%20ISA%20used%20in%20TCP/IP/UDP&In-Reply-To=&lt;200006201736.NAA08686@klos.com&gt;">patrick@klos.com</A>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;Klos Technologies, Inc.                Web:   <A HREF="http://www.klos.com/">http://www.klos.com/</A>
<BR>
============================================================================
<BR>
<P><!-- body="end" -->
<HR NOSHADE>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="2181.html">Vernon Schryver: "Re: ISA used in TCP/IP/UDP"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="2179.html">Joe Touch: "Re: ISA used in TCP/IP/UDP"</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="2166.html">Wilson C. Chung: "ISA used in TCP/IP/UDP"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="2182.html">Joe Touch: "Re: ISA used in TCP/IP/UDP"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="2182.html">Joe Touch: "Re: ISA used in TCP/IP/UDP"</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#2180">[ date ]</A>
<A HREF="index.html#2180">[ thread ]</A>
<A HREF="subject.html#2180">[ subject ]</A>
<A HREF="author.html#2180">[ author ]</A>
</UL>
<!-- trailer="footer" -->
<HR NOSHADE>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.hypermail.org/">hypermail 2b29</A> 
: <EM>Tue Sep 19 2000 - 11:54:34 EDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
