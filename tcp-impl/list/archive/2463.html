<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>TCP-IMPL Mailing List Archive: RE: Which implementation is bett</TITLE>
<META NAME="Author" CONTENT="Mahmoud Chilali (chilali@chilali.net)">
<META NAME="Subject" CONTENT="RE: Which implementation is better...">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>RE: Which implementation is better...</H1>
<!-- received="Thu Feb 15 14:18:35 2001" -->
<!-- isoreceived="20010215191835" -->
<!-- sent="Thu, 15 Feb 2001 19:57:47 +0100" -->
<!-- isosent="20010215185747" -->
<!-- name="Mahmoud Chilali" -->
<!-- email="chilali@chilali.net" -->
<!-- subject="RE: Which implementation is better..." -->
<!-- id="4.3.0.20010215194812.03f20c40@pop.free.fr" -->
<!-- inreplyto="02c001c096b7$6721e4f0$1703020a@lukeskywalker.dublin.iona.i e" -->
<STRONG>From:</STRONG> Mahmoud Chilali (<A HREF="mailto:chilali@chilali.net?Subject=RE:%20Which%20implementation%20is%20better...&In-Reply-To=&lt;4.3.0.20010215194812.03f20c40@pop.free.fr&gt;"><EM>chilali@chilali.net</EM></A>)<BR>
<STRONG>Date:</STRONG> Thu Feb 15 2001 - 13:57:47 EST
<P>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="2464.html">Ehab Al-Shaer: "CFP JOURNAL OF NETWORK AND SYSTEMS MANAGEMENT"</A>
<UL>
<LI><STRONG>Previous message:</STRONG> <A HREF="2462.html">Alan Cox: "Re: Which implementation is better..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="2453.html">der Mouse : "Re: time of queued connections if not reaped..."</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#2463">[ date ]</A>
<A HREF="index.html#2463">[ thread ]</A>
<A HREF="subject.html#2463">[ subject ]</A>
<A HREF="author.html#2463">[ author ]</A>
</UL>
<HR NOSHADE><P>
<!-- body="start" -->
<P>
At 18:53 14/02/01 +0000, ravi reddy wrote:
<BR>
<P><EM>&gt;   We do have a threshold. When the threshold is reached, we remove the
</EM><BR>
<EM>&gt;listener FD from the select FD set and issue a listen() call of 0.
</EM><BR>
<P>note that the backlog argument to listen is interepreted in a system
<BR>
dependent manner.
<BR>
<P><EM>&gt;When the
</EM><BR>
<EM>&gt;FD count goes down, we put back the listener FD and reset the listen queue
</EM><BR>
<EM>&gt;length. The only issue with this is that clients will wait for 75 seconds
</EM><BR>
<EM>&gt;before timing out (listen() call of 0 is ignored by BSD implementations
</EM><BR>
<EM>&gt;which allow one connection to go through to the complete connection queue
</EM><BR>
<EM>&gt;and this client will indefinitely wait). Other than using client-level
</EM><BR>
<EM>&gt;timeouts, we have no way to make these clients timeout before 75 seconds. If
</EM><BR>
<EM>&gt;there is a way, please let me know.
</EM><BR>
<P>the close after accept is probably faster (I don't have the state diag at 
<BR>
hands).
<BR>
<P><EM>&gt;   What this does is it makes the listener thread unnecessarily spin (by
</EM><BR>
<EM>&gt;accepting and closing)
</EM><BR>
<EM>&gt;without doing any meaningful work.
</EM><BR>
<P>probably, but replacing a &quot;accept+close&quot; with a &quot;listen+listen&quot; or with a
<BR>
&quot;close+socket+bind+listen&quot; doesn't add any meaningful stuff here.
<BR>
(Also, note that a program generally spends its time doing things that are not
<BR>
meaningful:)
<BR>
<P>The problem with your approach is that you add design constraints just to cope
<BR>
with a situation that should be exceptional. The accept/close approach is 
<BR>
trivial
<BR>
and won't &quot;happen&quot; under normal circumstances (by normal circumstances, I mean
<BR>
that you configure your system and software to have the correct threshold, and
<BR>
if the clients are yours, configure them to be &quot;friendly&quot;....)
<BR>
<P><P>regards,
<BR>
Mahmoud
<BR>
<P><!-- body="end" -->
<HR NOSHADE>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="2464.html">Ehab Al-Shaer: "CFP JOURNAL OF NETWORK AND SYSTEMS MANAGEMENT"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="2462.html">Alan Cox: "Re: Which implementation is better..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="2453.html">der Mouse : "Re: time of queued connections if not reaped..."</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#2463">[ date ]</A>
<A HREF="index.html#2463">[ thread ]</A>
<A HREF="subject.html#2463">[ subject ]</A>
<A HREF="author.html#2463">[ author ]</A>
</UL>
<!-- trailer="footer" -->
<HR NOSHADE>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.hypermail.org/">hypermail 2b29</A> 
: <EM>Thu Feb 15 2001 - 14:19:04 EST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
