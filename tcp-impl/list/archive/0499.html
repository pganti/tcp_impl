<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>TCP-IMPL Mailing List Archive: Re: TIME-WAIT truncation</TITLE>
<META NAME="Author" CONTENT="Eric.Schenk@dna.lth.se (Eric.Schenk@dna.lth.se)">
<META NAME="Subject" CONTENT="Re: TIME-WAIT truncation">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>Re: TIME-WAIT truncation</H1>
<!-- received="Thu Jun  5 17:26:13 1997" -->
<!-- isoreceived="19970605212613" -->
<!-- sent="Fri, 06 Jun 1997 02:20:18 +0200" -->
<!-- isosent="19970606002018" -->
<!-- name="Eric.Schenk@dna.lth.se" -->
<!-- email="Eric.Schenk@dna.lth.se" -->
<!-- subject="Re: TIME-WAIT truncation" -->
<!-- id="199706060020.CAA07517@rekk.dna.lth.se" -->
<!-- inreplyto="199706052337.RAA06775@mica.denver.sgi.com" -->
<STRONG>From:</STRONG> <A HREF="mailto:Eric.Schenk@dna.lth.se?Subject=Re:%20TIME-WAIT%20truncation&In-Reply-To=&lt;199706060020.CAA07517@rekk.dna.lth.se&gt;"><EM>Eric.Schenk@dna.lth.se</EM></A><BR>
<STRONG>Date:</STRONG> Thu Jun 05 1997 - 20:20:18 EDT
<P>
<!-- next="start" -->
<UL>
<LI><STRONG>Next message:</STRONG> <A HREF="0500.html">David S. Miller: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0498.html">Vernon Schryver: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0481.html">Vernon Schryver: "Re: TIME-WAIT truncation"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0502.html">Rick Jones: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0502.html">Rick Jones: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0505.html">Vernon Schryver: "Re: TIME-WAIT truncation"</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#499">[ date ]</A>
<A HREF="index.html#499">[ thread ]</A>
<A HREF="subject.html#499">[ subject ]</A>
<A HREF="author.html#499">[ author ]</A>
</UL>
<HR NOSHADE><P>
<!-- body="start" -->
<P>
Vernon Schryver &lt;<A HREF="mailto:vjs@mica.denver.sgi.com?Subject=Re:%20TIME-WAIT%20truncation&In-Reply-To=&lt;199706060020.CAA07517@rekk.dna.lth.se&gt;">vjs@mica.denver.sgi.com</A>&gt; writes:
<BR>
<EM>&gt;ONe reason I don't like the cookie ideas is that they are more
</EM><BR>
<EM>&gt;complicated and use up a lot of the sequence number space.
</EM><BR>
<P>Complicated yes. However, the idea can be integrated with the
<BR>
generation of secure sequence numbers in such a way that
<BR>
they do not use up much extra sequence number space.
<BR>
Currently my implementations wrap the space about twice
<BR>
as fast as a purely clock based implementation.
<BR>
<P><EM>&gt;Dealing with a stream of SYNs is only part of the problem.  It's also
</EM><BR>
<EM>&gt;nice to spread out your initial sequence numbers, so that if, for
</EM><BR>
<EM>&gt;example, you do happen to cheat on the 2*MSL in TIME_WAIT, then any
</EM><BR>
<EM>&gt;stale segments will be far away from the new window and so relatively
</EM><BR>
<EM>&gt;harmless.  If you use the initial sequence number for a cookie,
</EM><BR>
<EM>&gt;it can be hard to ensure that is far away from previous uses (plural)
</EM><BR>
<EM>&gt;of the same (addr,port,addr,port) 4-tuple.
</EM><BR>
<P>Acutally, there are a few tricks involved, but if you do it right
<BR>
you can guarantee that the sequence numbers generated by a cookie
<BR>
system are monotonically increasing for any given (addr,port,addr,port)
<BR>
4-tuple, without memorizing any information, and that the cookie
<BR>
numbers advance at roughly the usual clocked TCP rate. All without
<BR>
giving up more than a couple of bits of the security.
<BR>
This was all hashed out by Dan Berstein and myself on the syncookies
<BR>
mailing list last year.
<BR>
<P><EM>&gt;For CPU cycles/SYN, it's hard to beat Dave Borman's solution.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Large listen queues and careful drop policies are effective and tiny to
</EM><BR>
<EM>&gt;modest changes to existing code.  Given a solution that works, only
</EM><BR>
<EM>&gt;religion or compelling technical arguments can make you switch to some
</EM><BR>
<EM>&gt;other solution
</EM><BR>
<P>Initially I was fairly strongly in favor of this approach. I have
<BR>
come to dislike it for two reasons.
<BR>
<P>1) It requires changes to user space programs to enlarge the backlog
<BR>
&nbsp;&nbsp;&nbsp;queues. This means that lots of systems run by the relatively less
<BR>
&nbsp;&nbsp;&nbsp;informed will remain open to attack.
<BR>
<P>2) Unless you have insanely large backlog queues you end up cutting
<BR>
&nbsp;&nbsp;&nbsp;off people who have long delay paths to your server, or when the
<BR>
&nbsp;&nbsp;&nbsp;network is experiencing persistent loss. (Think packet radio,
<BR>
&nbsp;&nbsp;&nbsp;transatlantic cables, etc...) This is (barely) tollerable if
<BR>
&nbsp;&nbsp;&nbsp;you assume that the attacker will be attacking you over a modem
<BR>
&nbsp;&nbsp;&nbsp;or an ISDN link, unfortunately this has proved to be rather optimistic.
<BR>
&nbsp;&nbsp;&nbsp;I am aware of actual attacks that the ISP failed to track that were on
<BR>
&nbsp;&nbsp;&nbsp;the order of 2000 packets a second. In one case this went on for days.
<BR>
&nbsp;&nbsp;&nbsp;In this case a random drop or tail drop approach would not have helped
<BR>
&nbsp;&nbsp;&nbsp;at all.
<BR>
<P><PRE>
-- 
Eric Schenk                               www: <A HREF="http://www.dna.lth.se/~erics">http://www.dna.lth.se/~erics</A>
Dept. of Comp. Sci., Lund University          email: <A HREF="mailto:Eric.Schenk@dna.lth.se?Subject=Re:%20TIME-WAIT%20truncation&In-Reply-To=&lt;199706060020.CAA07517@rekk.dna.lth.se&gt;">Eric.Schenk@dna.lth.se</A>
Box 118, S-221 00 LUND, Sweden   fax: +46-46 13 10 21  ph: +46-46 222 96 38
</PRE>
<P><!-- body="end" -->
<HR NOSHADE>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0500.html">David S. Miller: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0498.html">Vernon Schryver: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0481.html">Vernon Schryver: "Re: TIME-WAIT truncation"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0502.html">Rick Jones: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0502.html">Rick Jones: "Re: TIME-WAIT truncation"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0505.html">Vernon Schryver: "Re: TIME-WAIT truncation"</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#499">[ date ]</A>
<A HREF="index.html#499">[ thread ]</A>
<A HREF="subject.html#499">[ subject ]</A>
<A HREF="author.html#499">[ author ]</A>
</UL>
<!-- trailer="footer" -->
<HR NOSHADE>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.hypermail.org/">hypermail 2b29</A> 
: <EM>Tue Sep 19 2000 - 11:44:25 EDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
