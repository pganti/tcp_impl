<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>TCP-IMPL Mailing List Archive: Re: TCP RST validation</TITLE>
<META NAME="Author" CONTENT="Andi Kleen (ak@muc.de)">
<META NAME="Subject" CONTENT="Re: TCP RST validation">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>Re: TCP RST validation</H1>
<!-- received="Fri Mar 13 09:43:25 1998" -->
<!-- isoreceived="19980313144325" -->
<!-- sent="13 Mar 1998 18:41:47 +0100" -->
<!-- isosent="19980313174147" -->
<!-- name="Andi Kleen" -->
<!-- email="ak@muc.de" -->
<!-- subject="Re: TCP RST validation" -->
<!-- id="k2iupisd2c.fsf@zero.aec.at" -->
<!-- inreplyto="Wed, 11 Mar 1998 13:07:10 -0500" -->
<STRONG>From:</STRONG> Andi Kleen (<A HREF="mailto:ak@muc.de?Subject=Re:%20TCP%20RST%20validation&In-Reply-To=&lt;k2iupisd2c.fsf@zero.aec.at&gt;"><EM>ak@muc.de</EM></A>)<BR>
<STRONG>Date:</STRONG> Fri Mar 13 1998 - 12:41:47 EST
<P>
<!-- next="start" -->
<UL>
<LI><STRONG>Next message:</STRONG> <A HREF="0985.html">Peter Ford: "RE: I-D ACTION:draft-ietf-tcpimpl-prob-03.txt"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0983.html">Internet-Drafts@ns.ietf.org: "I-D ACTION:draft-ietf-tcpimpl-prob-03.txt"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0978.html">Fred Bohle : "TCP RST validation"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#984">[ date ]</A>
<A HREF="index.html#984">[ thread ]</A>
<A HREF="subject.html#984">[ subject ]</A>
<A HREF="author.html#984">[ author ]</A>
</UL>
<HR NOSHADE><P>
<!-- body="start" -->
<P>
Fred Bohle  &lt;<A HREF="mailto:fab@md.interlink.com?Subject=Re:%20TCP%20RST%20validation&In-Reply-To=&lt;k2iupisd2c.fsf@zero.aec.at&gt;">fab@md.interlink.com</A>&gt; writes:
<BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; 	Is this a bug in the code, or a deliberate violation of
</EM><BR>
<EM>&gt; the RFC?  Or have I missed something?
</EM><BR>
<P>IMHO it is a bug. I allows nice DoS attacks (the well known 'nuke').
<BR>
I think FreeBSD has fixed this.
<BR>
<P><EM>&gt; 
</EM><BR>
<EM>&gt; 	We have a situation where an RST packet comes in that has
</EM><BR>
<EM>&gt; a sequence number which is out of the window (left of the current
</EM><BR>
<EM>&gt; number by a lot), and the code processes the RST.  But the RFC
</EM><BR>
<EM>&gt; says not to process it.  I wanted some input before I started making
</EM><BR>
<EM>&gt; code changes...
</EM><BR>
<P>I fixed this case in the Linux 2.1 code. So far nobody has complained.
<BR>
But there is a funny effect when the window gets very small or drops to
<BR>
null, that was fixed by checking against SEQ &lt;= rst &lt;= SEQ+min(window,32768).
<BR>
This attempts to make sure that a legal RST always gets through. 
<BR>
<P>-Andi
<BR>
<P><!-- body="end" -->
<HR NOSHADE>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0985.html">Peter Ford: "RE: I-D ACTION:draft-ietf-tcpimpl-prob-03.txt"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0983.html">Internet-Drafts@ns.ietf.org: "I-D ACTION:draft-ietf-tcpimpl-prob-03.txt"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0978.html">Fred Bohle : "TCP RST validation"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#984">[ date ]</A>
<A HREF="index.html#984">[ thread ]</A>
<A HREF="subject.html#984">[ subject ]</A>
<A HREF="author.html#984">[ author ]</A>
</UL>
<!-- trailer="footer" -->
<HR NOSHADE>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.hypermail.org/">hypermail 2b29</A> 
: <EM>Tue Sep 19 2000 - 11:52:25 EDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
